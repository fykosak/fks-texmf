%
% @author Michal Koutný <michal@fykos.cz>
% @author Adam Krška <adam.krska@fykos.cz>
%
% @description Informations about single seminars. Keeps the
%              LaTeX classes generic. Includes macro definitions meant to be
%              used in other places. Specific contest informations are
%              specified in .def files for each contest and its language.
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{fksmeta}[2011/09/11 Information about seminars]

% ----------------------
% Generic data getter
% ----------------------

\newcommand\fksMetaGet[1]{%
	\expandafter\ifx\csname fksMeta@#1\endcsname\relax
	\PackageWarning{fksmeta}{Undefined variable #1}
	\else
	\expandafter\csname fksMeta@#1\endcsname\fi
}

% ----------------------
% Helper macros for section titles with images
% ----------------------
\newcommand\sectionWithImageLeft[2]{
	\centering \includegraphics[height=20mm]{#1}\hspace{10pt}\raisebox{0.6cm}{#2}
}

\newcommand\sectionWithImageRight[2]{
	\centering \raisebox{0.6cm}{#2}\hspace{10pt}\includegraphics[height=20mm]{#1}
}

\newcommand\sectionWithImages[3]{
	\centering \includegraphics[height=20mm]{#1}\hspace{10pt}\raisebox{0.6cm}{#3}\hspace{10pt}\includegraphics[height=20mm]{#2}
}

% ----------------------
% Command initialization
% ----------------------

% init maketitle
\renewcommand\maketitle{}

% generic contest variables
\newcommand\fksMeta@contestNameFull{Name displayed in the header}
\newcommand\fksMeta@contestNameShort{Short name of the contest}
\newcommand\fksMeta@webDomain{Web and mail domain}
\newcommand\fksMeta@serialTitle{Title name used for series}
\newcommand\fksMeta@problemSolutionTitle{Title name used for solutions}
\newcommand\fksMeta@formatContestYear[1]{\Roman{#1}}

% text used in headers
\newcommand\fksMeta@headerLeft{}
\newcommand\fksMeta@headerRight{}

% external redefinition of headers
\newcommand\leftheader[1]{
	\renewcommand\fksMeta@headerLeft{#1}}
\newcommand\rightheader[1]{
	\renewcommand\fksMeta@headerRight{#1}}

% legal and contact information
\newcommand\fksMeta@address{Contact address}
\newcommand\fksMeta@licence{Licence}

% Texts used in sections
\newcommand\fksMeta@sectionTextProblemTasks{Zadání \Roman{batch}. série}
\newcommand\fksMeta@sectionTextProblemTasksSummer{Zadání \Roman{batch}. části prázdninové série}
\newcommand\fksMeta@sectionTextProblemSolutions{Řešení \Roman{solvedbatch}. série}
\newcommand\fksMeta@sectionTextProblemSolutionsSummer{Řešení \Roman{solvedbatch}. části prázdninové série}
\newcommand\fksMeta@sectionTextSeries[1]{\fksMeta@serialTitle: #1}
\newcommand\fksMeta@sectionTextResults{Pořadí řešitelů po \Roman{solvedbatch}. sérii}
\newcommand\fksMeta@sectionTextResultsSummer{Konečné pořadí řešitelů prázdninové série}

% Styles of sections
\newcommand\fksMeta@sectionStyleProblemTasks{\fksMeta@sectionTextProblemTasks}
\newcommand\fksMeta@sectionStyleProblemTasksSummer{\fksMeta@sectionTextProblemTasksSummer}
\newcommand\fksMeta@sectionStyleProblemSolutions{\fksMeta@sectionTextProblemSolutions}
\newcommand\fksMeta@sectionStyleProblemSolutionsSummer{\fksMeta@sectionTextProblemSolutionsSummer}
\newcommand\fksMeta@sectionStyleSeries[1]{\fksMeta@sectionTextSeries{#1}}
\newcommand\fksMeta@sectionStyleResults{\fksMeta@sectionTextResults}
\newcommand\fksMeta@sectionStyleResultsSummer{\fksMeta@sectionTextResultsSummer}

% data used by problems
\newcommand\fksMeta@problemDefaultStudyYears{}
\newcommand\fksMeta@problemLetter[1]{%
	\ifcase #1%
		\relax\or%
		1\else%
		\@ctrerr%
	\fi%
}

% results table parameter
\RequirePackage{array} % provide newcolumntype macro
\newcommand\fksMeta@tableColumnsResults{} % column definitions for name, school, points, sum etc.
\newcommand\fksMeta@tableHeaderResultsTasks{} % table header for task points
\newcommand\fksMeta@tableHeaderResults{} % table header

% ----------------------
% Load config files
% ----------------------

\IfFileExists{fksmeta.def}{
	\input{fksmeta.def}
}{
	\PackageError{fksmeta}{
		Config file fksmeta.def not found%
	}{
		Check if fksmeta.def is created and TeX can reach it (file must be in
		the same directory as tex is run from or you need to specify TEXINPUTS
		variable so tex knows, where to search for it).%
	}
}

\RequirePackage{fkslang}

% define language variant of config file
% \langCode from fkslang cannot be used due to macro expanding, so the language
% code is explicitly retrieved from @langCode macro
\newcommand\fksMeta@configFilename{%
	fksmeta.\langCode.def
}

\IfFileExists{\fksMeta@configFilename}{
	\input{\fksMeta@configFilename}
	\PackageInfo{fksmeta}{
		Language config file \fksMeta@configFilename found, importing
	}
}{
	\PackageInfo{fksmeta}{
		Language config file \fksMeta@configFilename not found, skipping
	}
}

\ProcessOptions\relax
